@using FacturacionVERIFACTU.Web.Services
@using FacturacionVERIFACTU.Web.Models.DTOs
@using FacturacionVERIFACTU.Web.Services
@inject IAuthService AuthService
@inject NavigationManager Nav

<div class="notion-sidebar-header">
    <div class="sidebar-logo">
        <i class="bi bi-box-seam-fill"></i>
        <span>Verifactu Pro</span>
    </div>
</div>

<nav class="notion-nav-group">
    <div class="nav-section-label">Menú Principal</div>

    <NavLink class="nav-item-link" href="/" Match="NavLinkMatch.All">
        <i class="bi bi-grid-1x2"></i>
        <span>Dashboard</span>
    </NavLink>
    
    <NavLink class="nav-item-link" href="/presupuestos">
        <i class="bi bi-file-earmark-text"></i>
        <span>Presupuestos</span>
    </NavLink>

    <NavLink class="nav-item-link" href="/facturas">
        <i class="bi bi-receipt"></i>
        <span>Facturas</span>
    </NavLink>

    <NavLink class="nav-item-link" href="/Clientes">
        <i class="bi bi-people"></i>
        <span>Clientes</span>
    </NavLink>

    <NavLink class="nav-item-link" href="/productos">
        <i class="bi bi-archive"></i>
        <span>Productos</span>
    </NavLink>

    <NavLink class="nav-item-link" href="/tipos-impuesto">
        <i class="bi bi-percent"></i>
        <span>Tipos de impuesto</span>
    </NavLink>

    <NavLink class="nav-item-link" href="/empresa">
        <i class="bi bi-building"></i>
        <span>Mi empresa</span>
    </NavLink>

    <AuthorizeView Roles="Admin">
        <NavLink class="nav-item-link" href="/usuarios">
            <i class="bi bi-person-badge"></i>
            <span>Usuarios</span>
        </NavLink>
    </AuthorizeView>
</nav>

<nav class="notion-nav-group logout-section">
    <hr class="sidebar-divider" />
           <NavLink class="nav-item-link" href="/perfil">
                <i class="bi bi-gear"></i>
                <span>Mi perfil</span>
           </NavLink>
    <button class="nav-item-link logout-btn" @onclick="HandleLogout">
        <i class="bi bi-box-arrow-right"></i>
        <span>Cerrar Sesión</span>
    </button>
</nav>


@code {
    private UserInfo? currentUser;

    protected override async Task OnInitializedAsync()
    {
        currentUser = await AuthService.GetCurrentUserAsync();
    }

    private async Task HandleLogout()
    {
        await AuthService.LogoutAsync();
        Nav.NavigateTo("/login", true);
    }
}