diff a/FacturacionVERIFACTU.Web/Components/Pages/Presupuestos/PresupuestoEditor.razor b/FacturacionVERIFACTU.Web/Components/Pages/Presupuestos/PresupuestoEditor.razor	(rejected hunks)
@@ -1028,51 +1027,51 @@
         {
             return;
         }
 
         var linea = new LineaPresupuestoViewModel
         {
             Descripcion = producto.Descripcion,
             Cantidad = 1,
             PrecioUnitario = producto.PrecioUnitario,
             PorcentajeDescuento = 0,
             IVA = producto.IVA,
             ArticuloId = producto.ProductoId,
             ArticuloCodigo = producto.Codigo
         };
 
         if (producto.TipoImpuestoId.HasValue)
         {
             linea.TipoImpuestoId = producto.TipoImpuestoId;
             AplicarTipoImpuesto(linea);
         }
         else
         {
             var tipoDefault = ObtenerTipoImpuestoPorDefecto();
             if (tipoDefault != null)
             {
-                linea.TipoImpuestoId = tipoDefault.TipoImpuestoId;
+                linea.TipoImpuestoId = tipoDefault.Id;
                 AplicarTipoImpuesto(linea);
                 avisoImpuestos = $"El producto {producto.Codigo} no tiene tipo de impuesto asignado. Se aplicÃ³ {tipoDefault.Nombre} por defecto.";
             }
             else
             {
                 avisoImpuestos = $"El producto {producto.Codigo} no tiene tipo de impuesto asignado.";
             }
         }
 
         presupuesto.Lineas.Add(linea);
 
         CerrarModalProductos();
         StateHasChanged();
     }
 
     private LineaPresupuestoDto MapLineaRequest(LineaPresupuestoViewModel linea)
     {
         return new LineaPresupuestoDto
         {
             Id = linea.Id,
             TipoImpuestoId = linea.TipoImpuestoId,
             Descripcion = linea.Descripcion,
             Cantidad = linea.Cantidad,
             PrecioUnitario = linea.PrecioUnitario,
             PorcentajeDescuento = linea.PorcentajeDescuento,
@@ -1123,96 +1122,96 @@
     private decimal TotalPresupuesto => presupuesto.Lineas.Sum(CalcularTotalLinea);
     private decimal TotalRetencion => TotalBaseImponible * ((presupuesto.PorcentajeRetencion ?? 0m) / 100m);
     private decimal TotalConRetencion => TotalPresupuesto - TotalRetencion;
 
     private void ActualizarClienteRecargo()
     {
         var cliente = clientes.FirstOrDefault(c => c.ClienteId == presupuesto.ClienteId);
         aplicaRecargoEquivalencia = cliente?.RegimenRecargoEquivalencia ?? false;
         if (!aplicaRecargoEquivalencia)
         {
             return;
         }
 
         foreach (var linea in presupuesto.Lineas.Where(l => l.TipoImpuestoId.HasValue && !l.RecargoEquivalencia.HasValue))
         {
             AplicarTipoImpuesto(linea);
         }
     }
 
     private LineaPresupuestoViewModel CrearLineaConTipoPorDefecto()
     {
         var linea = new LineaPresupuestoViewModel();
         var tipoDefault = ObtenerTipoImpuestoPorDefecto();
         if (tipoDefault != null)
         {
-            linea.TipoImpuestoId = tipoDefault.TipoImpuestoId;
+            linea.TipoImpuestoId = tipoDefault.Id;
             AplicarTipoImpuesto(linea);
         }
 
         return linea;
     }
 
-    private TipoImpuestoDto? ObtenerTipoImpuestoPorDefecto()
+    private TipoImpuestoListadoDto? ObtenerTipoImpuestoPorDefecto()
     {
         return tiposImpuesto.FirstOrDefault(tipo =>
                 tipo.Activo && tipo.Nombre.Equals("General", StringComparison.OrdinalIgnoreCase))
             ?? tiposImpuesto.FirstOrDefault(tipo => tipo.Activo);
     }
 
     private void ActualizarImpuestoLinea(LineaPresupuestoViewModel linea)
     {
         AplicarTipoImpuesto(linea);
     }
 
     private void AplicarTipoImpuesto(LineaPresupuestoViewModel linea)
     {
         if (!linea.TipoImpuestoId.HasValue)
         {
             return;
         }
 
-        var tipo = tiposImpuesto.FirstOrDefault(t => t.TipoImpuestoId == linea.TipoImpuestoId);
+        var tipo = tiposImpuesto.FirstOrDefault(t => t.Id == linea.TipoImpuestoId);
         if (tipo == null)
         {
             return;
         }
 
-        linea.IVA = tipo.PorcentajeIVA;
+        linea.IVA = tipo.PorcentajeIva;
         linea.RecargoEquivalencia = aplicaRecargoEquivalencia
-            ? tipo.PorcentajeRecargoEquivalencia ?? 0m
+            ? tipo.PorcentajeRecargo ?? 0m
             : 0m;
     }
 
     private string ObtenerDescripcionImpuesto(ProductoDto producto)
     {
         if (producto.TipoImpuestoId.HasValue)
         {
-            var tipo = tiposImpuesto.FirstOrDefault(t => t.TipoImpuestoId == producto.TipoImpuestoId);
+            var tipo = tiposImpuesto.FirstOrDefault(t => t.Id == producto.TipoImpuestoId);
             if (tipo != null)
             {
-                return $"{tipo.Nombre} ({tipo.PorcentajeIVA:N2}% IVA)";
+                return $"{tipo.Nombre} ({tipo.PorcentajeIva:N2}% IVA)";
             }
         }
 
         return producto.IVA.HasValue ? $"IVA legado {producto.IVA.Value:N2}%" : "Sin asignar";
     }
 
     private static decimal CalcularRecargoEquivalencia(decimal iva)
     {
         return iva switch
         {
             21m => 5.2m,
             10m => 1.4m,
             4m => 0.5m,
             0m => 0m,
             _ => 0m
         };
     }
 
     private static DateTime? ConvertirAUtc(DateTime? value)
     {
         if (!value.HasValue)
         {
             return null;
         }
 
