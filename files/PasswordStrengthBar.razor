@* Componente: barra visual de fortaleza de contraseña *@
@* Ruta: FacturacionVERIFACTU.Web/Components/Shared/PasswordStrengthBar.razor *@

@if (!string.IsNullOrEmpty(Password))
{
    <div style="margin-top: 6px;">
        <div style="display:flex; gap:4px; margin-bottom:4px;">
            @for (int i = 0; i < 4; i++)
            {
                var idx = i;
                <div style="
                    flex:1; height:4px; border-radius:2px;
                    background: @(idx < Nivel ? ColorNivel : "#e0e0e0");
                    transition: background .3s ease;">
                </div>
            }
        </div>
        <span style="font-size:11px; color:@ColorNivel; font-weight:500;">@TextoNivel</span>
    </div>
}

@code {
    [Parameter] public string Password { get; set; } = string.Empty;

    private int Nivel => CalcularNivel();
    private string ColorNivel => Nivel switch { 1 => "#e03e3e", 2 => "#e88c30", 3 => "#2d8653", 4 => "#0f7b0f", _ => "#e0e0e0" };
    private string TextoNivel => Nivel switch { 1 => "Débil", 2 => "Regular", 3 => "Buena", 4 => "Muy fuerte", _ => "" };

    private int CalcularNivel()
    {
        if (string.IsNullOrEmpty(Password)) return 0;
        int puntos = 0;
        if (Password.Length >= 8) puntos++;
        if (Password.Any(char.IsUpper) && Password.Any(char.IsLower)) puntos++;
        if (Password.Any(char.IsDigit)) puntos++;
        if (Password.Any(c => "@$!%*?&".Contains(c))) puntos++;
        return puntos;
    }
}
